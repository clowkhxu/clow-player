<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trình Phát Video</title>
    <!-- CSS để đảm bảo player lấp đầy màn hình -->
    <style>
        body,
        html {
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
            overflow: hidden;
            /* Ẩn thanh cuộn */
            background-color: #000;
            /* Nền đen cho trang */
        }

        #videoPlayerContainer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
    </style>
    <!-- JW Player Library -->
    <script src="https://fle-rvd0i9o8-moo.com/player/jw8_26/jwplayer.js?v=5.0.2"></script>
    <!-- Khóa JW Player Key -->
    <script type="text/javascript">
        jwplayer.key = 'eNFaXCjyURVoCCGiHp7HTQ3hDhE/AfL0g8VE1fRbL84=';
    </script>
</head>

<body>
    <!-- Vùng chứa cho trình phát video -->
    <div id="videoPlayerContainer"></div>

    <script type="text/javascript">
        // Hàm để lấy URL video từ tham số truy vấn (query parameter) của trang web
        function getVideoStreamUrl() {
            // Tạo một đối tượng để dễ dàng làm việc với các tham số trên URL
            const urlParams = new URLSearchParams(window.location.search);

            // Kiểm tra xem có tham số 'url' trên URL không
            if (urlParams.has('url')) {
                // Lấy giá trị của tham số 'url' và giải mã nó
                const videoUrl = urlParams.get('url');
                return decodeURIComponent(videoUrl);
            }

            // Trả về một video mặc định nếu không tìm thấy tham số 'url'
            console.error("Không tìm thấy tham số 'url' trong đường dẫn. Sử dụng video mặc định.");
            return 'https://vjs.zencdn.net/v/oceans.mp4';
        }

        // Lấy URL video
        const videoSource = getVideoStreamUrl();
        // Lấy URL gốc của trang, không bao gồm tham số
        const baseUrl = window.location.protocol + '//' + window.location.host + window.location.pathname;
        const currentShareLink = baseUrl + '?url=' + encodeURIComponent(videoSource);

        // Cấu hình và khởi tạo JW Player
        jwplayer("videoPlayerContainer").setup({
            file: videoSource, // Sử dụng nguồn video đã được lấy từ URL
            image: "https://images.pexels.com/photos/1001682/pexels-photo-1001682.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=650&w=940",
            title: 'Trình Phát Video',
            description: 'Phát từ liên kết M3U8 hoặc MPD',
            width: '100%',
            height: '100%',
            aspectratio: '16:9',
            autostart: true, // Tự động phát video
            captions: {
                color: '#ffb800',
                fontSize: 20,
                backgroundOpacity: 0
            },
            sharing: {
                // Tự động tạo link chia sẻ dựa trên URL hiện tại
                code: encodeURI(`<iframe src='${currentShareLink}' width='640' height='360' frameborder='0' scrolling='no' allowfullscreen></iframe>`),
                link: currentShareLink,
                sites: ['facebook', 'twitter', 'email']
            }
        });
    </script>
</body>

</html>